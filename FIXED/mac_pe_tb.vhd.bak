library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity mac_pe_tb is
end mac_pe_tb;

architecture behavior of mac_pe_tb is
    signal clock : std_logic := '0';
    signal in_a  : signed(15 downto 0);
    signal in_b  : signed(15 downto 0);
    signal in_c  : signed(15 downto 0);
    signal res   : signed(15 downto 0);

    component mac_pe is
        port (
            clock : in std_logic;
            in_a  : in signed(15 downto 0);
            in_b  : in signed(15 downto 0);
            in_c  : in signed(15 downto 0);
            res   : out signed(15 downto 0)
        );
    end component;
begin
    UUT: mac_pe
        port map (
            clock => clock,
            in_a  => in_a,
            in_b  => in_b,
            in_c  => in_c,
            res   => res
        );

    clock_process : process
    begin
        while true loop
            clock <= '0';
            wait for 10 ns;
            clock <= '1';
            wait for 10 ns;
        end loop;
    end process;

    stimulus_process: process
    begin
        -- Test: 3564 * 35233 con accumulatore zero
        in_a <= to_signed(3564, 16);  -- Q2.13
        in_b <= to_signed(-12595, 16); -- Q2.13
        in_c <= to_signed(0, 16);     -- Q2.13
        wait for 20 ns;

        -- Fine test
        wait;
    end process;
end behavior;